<!DOCTYPE html>

<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle Financeiro Moderno</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --cor-primaria: #0d6efd;
            --cor-receita: #198754;
            --cor-despesa: #dc3545;
            --cor-fundo: #f7f8fb;
            --cor-card: #fff;
            --cor-borda: #e9ecef;
            --cor-cinza: #6c757d;
            --cor-shadow: rgba(0,0,0,0.06);
        }
        * {margin:0;padding:0;box-sizing:border-box;}
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: var(--cor-fundo);
            min-height:100vh;
            color: #222;
        }
        .topbar {
            background: var(--cor-card);
            border-bottom: 1px solid var(--cor-borda);
            padding: 18px 0;
            box-shadow: 0 2px 8px var(--cor-shadow);
        }
        .topbar-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 16px;
            display: flex;
            align-items: center;
        }
        .logo {
            display: flex; 
            align-items: center; 
            gap: 12px;
            font-size: 1.5rem;
            font-weight: 700; 
            color: var(--cor-primaria);
        }
        .logo i {font-size:1.8rem;}
        .container {max-width:900px;margin:0 auto;padding:24px 16px;}
        .mes-selector {
            background: var(--cor-card);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 24px;
            box-shadow: 0 1px 5px var(--cor-shadow);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }
        .mes-selector button {
            background: var(--cor-fundo);
            border: none;
            width: 36px; 
            height: 36px;
            border-radius: 8px;
            cursor: pointer;
            display: flex; 
            align-items: center; 
            justify-content: center;
            color: var(--cor-cinza);
            font-size: 1rem;
            transition: all .2s;
        }
        .mes-selector button:hover {
            background: var(--cor-primaria);
            color: #fff;
        }
        .mes-atual {
            flex: 1; 
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            color: #222;
        }
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px,1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        .card {
            background: var(--cor-card);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px var(--cor-shadow);
        }
        .card-header {
            display: flex; 
            align-items: center; 
            gap: 8px; 
            margin-bottom: 12px;
        }
        .card-header i {
            font-size: 1.2rem;
            padding: 8px; 
            border-radius: 6px;
            background: var(--cor-fundo);
        }
        .card-header h3 {
            font-size: 0.9rem;
            font-weight: 600; 
            color: var(--cor-cinza);
            text-transform: uppercase;
        }
        .card-valor {
            font-size: 1.5rem;
            font-weight: 700;
        }
        .card.saldo .card-header i, .card.saldo .card-valor {color:var(--cor-primaria);}
        .card.receita .card-header i, .card.receita .card-valor {color:var(--cor-receita);}
        .card.despesa .card-header i, .card.despesa .card-valor {color:var(--cor-despesa);}


    .tabs-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        margin-bottom: 24px;
    }
    .tab-card {
        background: var(--cor-card);
        border-radius: 10px;
        box-shadow: 0 2px 8px var(--cor-shadow);
        overflow: hidden;
    }
    .tab-header {
        padding: 16px;
        background: var(--cor-primaria);
        color: #fff;
        display: flex; 
        align-items: center; 
        gap: 10px;
    }
    .tab-header i {font-size:1.2rem;}
    .tab-header h3 {font-size:1rem;font-weight:600;}
    .tab-content {
        max-height: 400px;
        overflow-y: auto;
    }
    
    .categoria-bloco { 
        margin: 16px;
        border-radius: 8px;
        border: 1px solid var(--cor-borda);
    }
    .categoria-titulo { 
        padding: 12px 16px;
        font-size: 0.95rem;
        font-weight: 700;
        color: var(--cor-primaria);
        background: var(--cor-fundo);
        display: flex;
        align-items: center;
        gap: 8px;
    }
    .transacao {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 16px;
        border-bottom: 1px solid var(--cor-borda);
        transition: background .2s;
    }
    .transacao:last-child {border-bottom: none;}
    .transacao:hover {background: var(--cor-fundo);}
    
    .transacao-icone {
        width: 32px;
        height: 32px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
        flex-shrink: 0;
    }
    .transacao.receita .transacao-icone {background:#d1e7dd;color:var(--cor-receita);}
    .transacao.despesa .transacao-icone {background:#f8d7da;color:var(--cor-despesa);}
    
    .transacao-info {
        flex: 1;
        min-width: 0;
    }
    .transacao-desc {
        font-size: 0.95rem;
        font-weight: 500;
        color: #222;
        margin-bottom: 4px;
    }
    .transacao-meta {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
    }
    .transacao-meta-item {
        background: #f8f9fa;
        border-radius: 4px;
        padding: 2px 8px;
        font-size: 0.8rem;
        color: #666;
        display: flex;
        align-items: center;
        gap: 4px;
    }
    
    .transacao-valor {
        font-size: 1rem;
        font-weight: 600;
        white-space: nowrap;
        margin-right: 8px;
    }
    .transacao.receita .transacao-valor {color:var(--cor-receita);}
    .transacao.despesa .transacao-valor {color:var(--cor-despesa);}
    
    .status-badge {
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 500;
        white-space: nowrap;
    }
    .status-badge.receita {background:#d1e7dd;color:#0a3622;}
    .status-badge.pendente {background:#fff3cd;color:#664d03;}
    .status-badge.paga {background:#d1e7dd;color:#0a3622;}
    
    .transacao-acoes {
        display: flex;
        gap: 4px;
    }
    .btn-acao {
        border: none;
        background: transparent;
        cursor: pointer;
        width: 28px;
        height: 28px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--cor-cinza);
        transition: all .2s;
    }
    .btn-acao:hover {
        background: var(--cor-primaria);
        color: #fff;
    }
    .btn-acao.delete:hover {
        background: var(--cor-despesa);
        color: #fff;
    }
    
    .lista-vazia {
        text-align: center;
        padding: 40px 20px;
        color: var(--cor-cinza);
    }
    .lista-vazia i {
        font-size: 3rem;
        color: #dee2e6;
        margin-bottom: 12px;
    }
    
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
    }
    .modal.ativo {display: flex;}
    
    .modal-conteudo {
        background: var(--cor-card);
        width: 90%;
        max-width: 500px;
        border-radius: 12px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        max-height: 90vh;
        overflow-y: auto;
    }
    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 1px solid var(--cor-borda);
    }
    .modal-header h2 {
        font-size: 1.3rem;
        font-weight: 600;
        color: var(--cor-primaria);
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .btn-fechar {
        background: transparent;
        border: none;
        width: 32px;
        height: 32px;
        border-radius: 6px;
        cursor: pointer;
        color: var(--cor-cinza);
        font-size: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all .2s;
    }
    .btn-fechar:hover {
        background: var(--cor-fundo);
        color: #222;
    }
    .modal-body {padding: 20px;}
    
    .tipo-selector {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-bottom: 20px;
    }
    .tipo-btn {
        padding: 12px;
        border: 2px solid #dee2e6;
        border-radius: 8px;
        background: white;
        cursor: pointer;
        font-weight: 600;
        font-size: 1rem;
        transition: all .2s;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        color: var(--cor-cinza);
    }
    .tipo-btn.receita.ativo {
        border-color: var(--cor-receita);
        background: #d1e7dd;
        color: var(--cor-receita);
    }
    .tipo-btn.despesa.ativo {
        border-color: var(--cor-despesa);
        background: #f8d7da;
        color: var(--cor-despesa);
    }
    
    .form-group {margin-bottom: 16px;}
    .form-group label {
        display: block;
        font-size: 0.95rem;
        font-weight: 600;
        color: #222;
        margin-bottom: 8px;
    }
    .form-group input, .form-group select {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #ced4da;
        border-radius: 6px;
        font-size: 1rem;
        font-family: inherit;
        transition: all .2s;
    }
    .form-group input:focus, .form-group select:focus {
        outline: none;
        border-color: var(--cor-primaria);
        box-shadow: 0 0 0 3px rgba(13,110,253,0.1);
    }
    
    .btn-submit {
        width: 100%;
        padding: 12px;
        background: var(--cor-primaria);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all .2s;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }
    .btn-submit:hover {
        background: #0b5ed7;
        transform: translateY(-1px);
    }
    
    .fab {
        position: fixed;
        bottom: 24px;
        right: 24px;
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: var(--cor-primaria);
        border: none;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        font-size: 1.5rem;
        color: white;
        transition: all .2s;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 500;
    }
    .fab:hover {
        background: #0b5ed7;
        transform: scale(1.1);
    }
    
    @media (max-width: 768px) {
        .tabs-row {
            grid-template-columns: 1fr;
        }
        .dashboard {
            grid-template-columns: 1fr;
        }
    }
</style>


</head>
<body>
    <div class="topbar">
        <div class="topbar-content">
            <div class="logo">
                <i class="fas fa-chart-line"></i>
                <span>Financeiro</span>
            </div>
        </div>
    </div>


<div class="container">
    <div class="mes-selector">
        <button id="btnMesAnterior"><i class="fas fa-chevron-left"></i></button>
        <div class="mes-atual" id="mesAtual"></div>
        <button id="btnMesProximo"><i class="fas fa-chevron-right"></i></button>
    </div>
    
    <div class="dashboard">
        <div class="card saldo">
            <div class="card-header">
                <i class="fas fa-wallet"></i>
                <h3>Saldo</h3>
            </div>
            <div class="card-valor" id="saldoAtual">R$ 0,00</div>
        </div>
        <div class="card receita">
            <div class="card-header">
                <i class="fas fa-arrow-up"></i>
                <h3>Receitas</h3>
            </div>
            <div class="card-valor" id="totalReceitas">R$ 0,00</div>
        </div>
        <div class="card despesa">
            <div class="card-header">
                <i class="fas fa-arrow-down"></i>
                <h3>Despesas</h3>
            </div>
            <div class="card-valor" id="totalDespesas">R$ 0,00</div>
        </div>
    </div>
    
    <div class="tabs-row">
        <div class="tab-card">
            <div class="tab-header">
                <i class="fas fa-clock"></i>
                <h3>Pendentes</h3>
            </div>
            <div class="tab-content" id="listaPendentes"></div>
        </div>
        
        <div class="tab-card">
            <div class="tab-header">
                <i class="fas fa-check-circle"></i>
                <h3>Pagas</h3>
            </div>
            <div class="tab-content" id="listaPagas"></div>
        </div>
    </div>
</div>

<button class="fab" id="btnAdicionar">
    <i class="fas fa-plus"></i>
</button>

<div class="modal" id="modal">
    <div class="modal-conteudo">
        <div class="modal-header">
            <h2><i class="fas fa-plus-circle"></i>Nova Transação</h2>
            <button class="btn-fechar" id="btnFechar">&times;</button>
        </div>
        <div class="modal-body">
            <div class="tipo-selector">
                <button class="tipo-btn receita ativo" data-tipo="receita">
                    <i class="fas fa-plus"></i>Receita
                </button>
                <button class="tipo-btn despesa" data-tipo="despesa">
                    <i class="fas fa-minus"></i>Despesa
                </button>
            </div>
            <form id="formulario">
                <div class="form-group">
                    <label>Descrição</label>
                    <input type="text" id="descricao" placeholder="Ex: Salário" required>
                </div>
                <div class="form-group">
                    <label>Valor (R$)</label>
                    <input type="number" id="valor" placeholder="0.00" step="0.01" min="0" required>
                </div>
                <div class="form-group">
                    <label>Categoria</label>
                    <select id="categoria" required>
                        <option value="">Selecione</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Data</label>
                    <input type="date" id="data" required>
                </div>
                <div class="form-group" id="parcelasGroup" style="display:none;">
                    <label>Parcelas</label>
                    <input type="number" id="parcelas" min="1" max="36" value="1">
                </div>
                <button type="submit" class="btn-submit">
                    <i class="fas fa-check"></i>Adicionar
                </button>
            </form>
        </div>
    </div>
</div>

<script>
    const CATEGORIAS = {
        receita: ['Salário', 'Freelance', 'Investimento', 'Outro'],
        despesa: ['Aluguel', 'Alimentação', 'Transporte', 'Carro', 'Lazer', 'Saúde', 'Outro']
    };
    
    const ICONES = {
        Salário: 'fa-money-bill-wave',
        Freelance: 'fa-briefcase',
        Investimento: 'fa-piggy-bank',
        Aluguel: 'fa-home',
        Alimentação: 'fa-utensils',
        Transporte: 'fa-bus',
        Carro: 'fa-car',
        Lazer: 'fa-gamepad',
        Saúde: 'fa-heartbeat',
        Outro: 'fa-circle'
    };
    
    const MESES = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                   'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
    
    let mesAtual = new Date().getMonth();
    let anoAtual = new Date().getFullYear();
    let tipoSelecionado = 'receita';
    
    const els = {
        mesAtual: document.getElementById('mesAtual'),
        btnMesAnterior: document.getElementById('btnMesAnterior'),
        btnMesProximo: document.getElementById('btnMesProximo'),
        saldoAtual: document.getElementById('saldoAtual'),
        totalReceitas: document.getElementById('totalReceitas'),
        totalDespesas: document.getElementById('totalDespesas'),
        listaPendentes: document.getElementById('listaPendentes'),
        listaPagas: document.getElementById('listaPagas'),
        btnAdicionar: document.getElementById('btnAdicionar'),
        modal: document.getElementById('modal'),
        btnFechar: document.getElementById('btnFechar'),
        formulario: document.getElementById('formulario'),
        descricao: document.getElementById('descricao'),
        valor: document.getElementById('valor'),
        categoria: document.getElementById('categoria'),
        data: document.getElementById('data'),
        parcelas: document.getElementById('parcelas'),
        parcelasGroup: document.getElementById('parcelasGroup'),
        tipoBtns: document.querySelectorAll('.tipo-btn')
    };
    
    function obterChave() {
        return `financeiro-${anoAtual}-${String(mesAtual + 1).padStart(2, '0')}`;
    }
    
    function carregarTransacoes() {
        const chave = obterChave();
        const dados = localStorage.getItem(chave);
        return dados ? JSON.parse(dados) : [];
    }
    
    function salvarTransacoes(transacoes) {
        const chave = obterChave();
        localStorage.setItem(chave, JSON.stringify(transacoes));
    }
    
    function formatarValor(valor) {
        return new Intl.NumberFormat('pt-BR', {
            style: 'currency',
            currency: 'BRL'
        }).format(valor);
    }
    
    function atualizarCategorias() {
        els.categoria.innerHTML = '<option value="">Selecione</option>';
        CATEGORIAS[tipoSelecionado].forEach(cat => {
            els.categoria.innerHTML += `<option value="${cat}">${cat}</option>`;
        });
        els.parcelasGroup.style.display = tipoSelecionado === 'despesa' ? 'block' : 'none';
    }
    
    function atualizarMes() {
        els.mesAtual.textContent = `${MESES[mesAtual]} ${anoAtual}`;
        els.data.value = `${anoAtual}-${String(mesAtual + 1).padStart(2, '0')}-01`;
        renderizar();
    }
    
    function renderizar() {
        const transacoes = carregarTransacoes();
        
        const receitas = transacoes.filter(t => t.tipo === 'receita');
        const despesasPendentes = transacoes.filter(t => t.tipo === 'despesa' && t.status === 'pendente');
        const despesasPagas = transacoes.filter(t => t.tipo === 'despesa' && t.status === 'paga');
        
        const totalReceitas = receitas.reduce((acc, t) => acc + t.valor, 0);
        const totalDespesasPendentes = despesasPendentes.reduce((acc, t) => acc + t.valor, 0);
        const totalDespesasPagas = despesasPagas.reduce((acc, t) => acc + t.valor, 0);
        const saldo = totalReceitas - totalDespesasPagas;
        
        els.saldoAtual.textContent = formatarValor(saldo);
        els.totalReceitas.textContent = formatarValor(totalReceitas);
        els.totalDespesas.textContent = formatarValor(totalDespesasPendentes);
        
        renderizarLista(els.listaPendentes, [...receitas, ...despesasPendentes]);
        renderizarLista(els.listaPagas, despesasPagas);
    }
    
    function renderizarLista(elemento, transacoes) {
        if (transacoes.length === 0) {
            elemento.innerHTML = `
                <div class="lista-vazia">
                    <i class="fas fa-inbox"></i>
                    <p>Nenhuma transação</p>
                </div>
            `;
            return;
        }
        
        const porCategoria = transacoes.reduce((acc, t) => {
            if (!acc[t.categoria]) acc[t.categoria] = [];
            acc[t.categoria].push(t);
            return acc;
        }, {});
        
        let html = '';
        Object.entries(porCategoria).forEach(([categoria, lista]) => {
            html += `
                <div class="categoria-bloco">
                    <div class="categoria-titulo">
                        <i class="fas fa-tag"></i>${categoria}
                    </div>
                    ${lista.map(t => `
                        <div class="transacao ${t.tipo}">
                            <div class="transacao-icone">
                                <i class="fas ${ICONES[t.categoria]}"></i>
                            </div>
                            <div class="transacao-info">
                                <div class="transacao-desc">${t.descricao}</div>
                                <div class="transacao-meta">
                                    <span class="transacao-meta-item">
                                        <i class="fas fa-calendar"></i>${new Date(t.data + 'T00:00:00').toLocaleDateString('pt-BR')}
                                    </span>
                                    ${t.parcela ? `
                                        <span class="transacao-meta-item">
                                            <i class="fas fa-receipt"></i>${t.parcela}/${t.totalParcelas}
                                        </span>
                                    ` : ''}
                                </div>
                            </div>
                            <div class="transacao-valor">
                                ${t.tipo === 'receita' ? '+' : '-'} ${formatarValor(t.valor)}
                            </div>
                            <span class="status-badge ${t.tipo === 'receita' ? 'receita' : t.status}">
                                ${t.tipo === 'receita' ? 'Recebida' : (t.status === 'paga' ? 'Paga' : 'Pendente')}
                            </span>
                            <div class="transacao-acoes">
                                ${t.tipo === 'despesa' ? `
                                    <button class="btn-acao" onclick="alternarStatus(${t.id})">
                                        <i class="fas ${t.status === 'paga' ? 'fa-undo' : 'fa-check'}"></i>
                                    </button>
                                ` : ''}
                                <button class="btn-acao delete" onclick="deletar(${t.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        });
        
        elemento.innerHTML = html;
    }
    
    window.alternarStatus = function(id) {
        const transacoes = carregarTransacoes();
        const t = transacoes.find(t => t.id === id);
        if (t && t.tipo === 'despesa') {
            t.status = t.status === 'paga' ? 'pendente' : 'paga';
            salvarTransacoes(transacoes);
            renderizar();
        }
    };
    
    window.deletar = function(id) {
        if (confirm('Deletar esta transação?')) {
            let transacoes = carregarTransacoes();
            transacoes = transacoes.filter(t => t.id !== id);
            salvarTransacoes(transacoes);
            renderizar();
        }
    };
    
    els.btnMesAnterior.addEventListener('click', () => {
        mesAtual--;
        if (mesAtual < 0) {
            mesAtual = 11;
            anoAtual--;
        }
        atualizarMes();
    });
    
    els.btnMesProximo.addEventListener('click', () => {
        mesAtual++;
        if (mesAtual > 11) {
            mesAtual = 0;
            anoAtual++;
        }
        atualizarMes();
    });
    
    els.btnAdicionar.addEventListener('click', () => {
        els.modal.classList.add('ativo');
    });
    
    els.btnFechar.addEventListener('click', () => {
        els.modal.classList.remove('ativo');
    });
    
    els.modal.addEventListener('click', (e) => {
        if (e.target === els.modal) {
            els.modal.classList.remove('ativo');
        }
    });
    
    els.tipoBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            els.tipoBtns.forEach(b => b.classList.remove('ativo'));
            btn.classList.add('ativo');
            tipoSelecionado = btn.dataset.tipo;
            atualizarCategorias();
        });
    });
    
    els.formulario.addEventListener('submit', (e) => {
        e.preventDefault();
        
        const descricao = els.descricao.value;
        const valor = parseFloat(els.valor.value);
        const categoria = els.categoria.value;
        const data = els.data.value;
        const numParcelas = tipoSelecionado === 'despesa' ? parseInt(els.parcelas.value) : 1;
        
        if (!descricao || !valor || !categoria || !data) {
            alert('Preencha todos os campos!');
            return;
        }
        
        // Para cada parcela, salvar no mês correspondente
        for (let i = 0; i < numParcelas; i++) {
            const dataOriginal = new Date(data + 'T00:00:00');
            dataOriginal.setMonth(dataOriginal.getMonth() + i);
            
            const mesParcela = dataOriginal.getMonth();
            const anoParcela = dataOriginal.getFullYear();
            const chaveParcela = `financeiro-${anoParcela}-${String(mesParcela + 1).padStart(2, '0')}`;
            
            const transacoesMes = localStorage.getItem(chaveParcela);
            const transacoes = transacoesMes ? JSON.parse(transacoesMes) : [];
            
            const transacao = {
                id: Date.now() + i,
                descricao: numParcelas > 1 ? `${descricao} (${i+1}/${numParcelas})` : descricao,
                valor: valor,
                categoria: categoria,
                tipo: tipoSelecionado,
                status: tipoSelecionado === 'receita' ? 'recebida' : 'pendente',
                data: dataOriginal.toISOString().split('T')[0],
                parcela: numParcelas > 1 ? i + 1 : null,
                totalParcelas: numParcelas > 1 ? numParcelas : null
            };
            
            transacoes.push(transacao);
            localStorage.setItem(chaveParcela, JSON.stringify(transacoes));
        }
        
        renderizar();
        els.formulario.reset();
        els.modal.classList.remove('ativo');
        els.data.value = `${anoAtual}-${String(mesAtual + 1).padStart(2, '0')}-01`;
    });
    
    atualizarCategorias();
    atualizarMes();
</script>


</body>
</html>
