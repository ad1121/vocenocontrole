<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle Financeiro</title>
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkNvbnRyb2xlIEZpbmFuY2Vpcm8iLAogICJzaG9ydF9uYW1lIjogIkZpbmFuw6dhcyIsCiAgImRlc2NyaXB0aW9uIjogIkdlcmVuY2llIHN1YXMgZmluYW7Dp2FzIGRlIGZvcm1hIGludGVsaWdlbnRlIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiMwMEQ0QUEiLAogICJ0aGVtZV9jb2xvciI6ICIjMDBENEFBIiwKICAib3JpZW50YXRpb24iOiAicG9ydHJhaXQiLAogICJjYXRlZ29yaWVzIjogWyJmaW5hbmNlIiwgInByb2R1Y3Rpdml0eSJdLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhNakFpSUdobGFXZG9kRDBpTVRJd0lqNDhZMmx5WTJ4bElHTjRQU0kyTUNJZ1kzazlJall3SWlCeVBTSTFNQ0lnWm1sc2JEMGlJekF3UkRSQlFTSXZQanh3WVhSb0lHUTlJazB6TUNBMk1XZ3pNR013TFRFdU5qVXRNUzR6TlMxemJDMHpMall6TFRNek1TNTJNeTB4TGpnM2JEVTNMak15SURJMExqWTBZakUyTGprd0lERXVOVEVnTXpFdU5qZ3RJRFV1TVRVdE1qZ2dNUzQzTlNBeExqa3dJRE11TVRrZ01TNHpNaUEyTlM0NE5pQXlPUzR5TVhvaUlHWnBiR3c5SW1acVptWWlMejQ4TDNOMlp6ND0iLAogICAgICAic2l6ZXMiOiAiMTIweDEyMCIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9LAogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owcVlXNTBJSGRwWkhSb1BTSXhPVElpSUdobGFXZG9kRDBpTVRreUlqNDhZMmx5WTJ4bElHTjRQU0k1TmlJZ1kzazlJamt5SWlCeVBTSTRNQ0lnWm1sc2JEMGlJekF3UkRSQlFTSXZQanh3WVhSb0lHUTlJazB6TUNBMk1XZ3pNR013TFRFdU5qVXRNUzR6TlMxemJDMHpMall6TFRNek1TNTJNUzQzTlMxMExqZ3pkRFV1TVRVdE1qZ2dNUzQzTlNBeExqa3dJRE11TVRrZ01TNHpNaUEyTlM0NE5pQXlPUzR5TVZ0eGRHa2VMejQ4TDNOMlp6ND0iLAogICAgICAic2l6ZXMiOiAiMTkyeDE5MiIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9LAogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owcWFIUjBjRG92TDNkM2R5NTNNeTUyTURFaUlIZHBaR1VwT21JQlQzT2lJR2hsYVdkb2REMGlOVEV5SWo0OFkySnlaRFlpUXljeTFrVkNRU0lnWm1sc2JEMGlJekF3UkVSQlFTSGpQanh3WVhSb0lHUTlJazA2VEVSQlhRSXBkRUZCU0lHQlE1aXdvSm1OQlFTSWpOdUVOU0JNUkJhOFJPQXRoQkFNa3J5ZDF6QVplZDFZSTRnVGNNenNXU1QzeVNEM3kyOSIsCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0KICBdCn0=">
    <meta name="theme-color" content="#00D4AA">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Finan√ßas">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIj48Y2lyY2xlIGN4PSI2MCIgY3k9IjYwIiByPSI1MCIgZmlsbD0iIzAwRDRBQSIvPjxwYXRoIGQ9Ik0zMCA2MWgzMGMwLTEuNjUtMS4zNS1zYy0zLjYzLTMzMS52My0xLjg3bDU3LjMyIDI0LjY0YjE2LjkwIDEuNTEgMzEuNjgtIDUuMTUtMjggMS43NSAxLjkwIDMuMTkgMS4zMiA2NS44NiAyOS4yMVoiIGZpbGw9ImZmZiIvPjwvc3ZnPg==">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiI+PGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTQiIGZpbGw9IiMwMEQ0QUEiLz48dGV4dCB4PSIxNiIgeT0iMjIiIGZpbGw9IndoaXRlIiBmb250LXNpemU9IjE4IiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgdGV4dC1hbmNob3I9Im1pZGRsZSI+8J+SsDwvdGV4dD48L3N2Zz4=">
    <style>
        :root {
            --primary-positive: #00D4AA;
            --primary-negative: #FF6B6B;
            --primary-warning: #FFB800;
            --primary-neutral: #0EA5E9;
            --bg-gradient: linear-gradient(135deg, #0EA5E9 0%, #00D4AA 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.18);
            --shadow-soft: 0 8px 32px rgba(0, 0, 0, 0.1);
            --shadow-strong: 0 20px 60px rgba(0, 0, 0, 0.15);
            --text-primary: #1A1A1A;
            --text-secondary: #6B7280;
            --border-radius: 20px;
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-primary);
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(14, 165, 233, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 107, 107, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 212, 170, 0.2) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            width: 100%;
            min-height: 100vh;
            position: relative;
        }

        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #00D4AA, #0EA5E9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .welcome-content {
            max-width: 400px;
            width: 100%;
            animation: fadeInUp 0.8s ease-out;
        }

        .welcome-form {
            background: var(--glass-bg);
            padding: 40px 30px;
            border-radius: var(--border-radius);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow-strong);
        }

        .welcome-title {
            font-size: 36px;
            margin-bottom: 12px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .welcome-subtitle {
            font-size: 18px;
            margin-bottom: 40px;
            opacity: 0.9;
            font-weight: 400;
        }

        .welcome-input {
            width: 100%;
            padding: 18px 20px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            margin-bottom: 25px;
            text-align: center;
            background: white;
            color: var(--text-primary);
            font-weight: 500;
            transition: var(--transition);
        }

        .welcome-input:focus {
            outline: none;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .welcome-btn {
            width: 100%;
            padding: 18px;
            background: white;
            color: #00D4AA;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
        }

        .welcome-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .emoji-icon {
            font-size: 80px;
            margin-bottom: 20px;
            display: block;
        }

        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            color: white;
            padding: 30px 25px;
            text-align: center;
            position: relative;
            border-bottom: 1px solid var(--glass-border);
            transition: var(--transition);
        }

        .greeting {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 8px;
            font-weight: 400;
        }

        .username {
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .balance-card {
            background: white;
            margin: 25px;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-soft);
            position: relative;
            overflow: hidden;
            transition: var(--transition);
        }

        .balance-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary-positive);
            transition: var(--transition);
        }

        .balance-title {
            color: var(--text-secondary);
            font-size: 15px;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .balance-amount {
            font-size: 36px;
            font-weight: 800;
            color: var(--primary-positive);
            transition: var(--transition);
            letter-spacing: -0.02em;
        }

        .accounts-section, .transaction-list {
            margin: 25px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-primary);
            letter-spacing: -0.01em;
        }

        .account-item, .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 20px;
            border-radius: 18px;
            margin-bottom: 12px;
            box-shadow: var(--shadow-soft);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .account-item:hover, .transaction-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-strong);
        }

        .account-info, .transaction-details {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .account-icon, .transaction-icon {
            width: 50px;
            height: 50px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
            font-weight: 600;
        }

        .account-icon {
            background: linear-gradient(135deg, #F3F4F6, #E5E7EB);
        }

        .transaction-icon.income {
            background: linear-gradient(135deg, #ECFDF5, #D1FAE5);
            color: var(--primary-positive);
        }

        .transaction-icon.expense {
            background: linear-gradient(135deg, #FEF2F2, #FECACA);
            color: var(--primary-negative);
        }

        .account-details h4, .transaction-details h4 {
            font-size: 17px;
            color: var(--text-primary);
            margin-bottom: 4px;
            font-weight: 600;
        }

        .account-details p, .transaction-details p {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .account-balance, .transaction-amount {
            font-weight: 700;
            font-size: 16px;
        }

        .account-balance, .transaction-amount.income {
            color: var(--primary-positive);
        }

        .transaction-amount.expense {
            color: var(--primary-negative);
        }

        .expense-tracker {
            margin: 25px;
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow-soft);
            transition: var(--transition);
        }

        .expense-bar {
            background: #F3F4F6;
            height: 12px;
            border-radius: 20px;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }

        .expense-fill {
            height: 100%;
            border-radius: 20px;
            transition: var(--transition);
            position: relative;
        }

        .expense-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        .expense-info {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 15px;
        }

        .expense-limit {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .expense-current {
            font-weight: 700;
            color: var(--primary-negative);
        }

        .navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            padding: 8px 0 15px 0;
            border-top: 1px solid var(--glass-border);
            z-index: 100;
        }

        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
            max-width: 400px;
            margin: 0 auto;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 6px 8px;
            cursor: pointer;
            transition: var(--transition);
            color: rgba(255, 255, 255, 0.6);
            position: relative;
        }

        .nav-item.active {
            color: white;
            transform: translateY(-3px);
        }

        .nav-item:hover {
            color: white;
            transform: translateY(-2px);
        }

        .add-btn {
            background: linear-gradient(135deg, var(--primary-positive), #0EA5E9);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 14px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--shadow-soft);
            transition: var(--transition);
            font-weight: 300;
        }

        .add-btn:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: var(--shadow-strong);
        }

        .tab-content {
            display: none;
            padding-bottom: 80px;
            min-height: calc(100vh - 80px);
            overflow-y: auto;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 16px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid #F3F4F6;
            border-radius: 15px;
            font-size: 16px;
            transition: var(--transition);
            background: white;
            font-weight: 500;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary-positive);
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(0, 212, 170, 0.15);
        }

        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--primary-positive), #0EA5E9);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-soft);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-strong);
        }

        .chart-container {
            background: white;
            margin: 25px;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-soft);
            min-height: 300px;
        }

        .chart {
            width: 100%;
            height: 250px !important;
            margin: 20px 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 25px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 18px;
            text-align: center;
            box-shadow: var(--shadow-soft);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-strong);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            transition: var(--transition);
        }

        .stat-card:first-child::before {
            background: var(--primary-positive);
        }

        .stat-card:last-child::before {
            background: var(--primary-negative);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 8px;
            letter-spacing: -0.02em;
        }

        .stat-label {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .prediction-card {
            background: linear-gradient(135deg, #0EA5E9, #00D4AA);
            color: white;
            margin: 25px;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-soft);
            position: relative;
            overflow: hidden;
        }

        .prediction-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .no-data-message {
            text-align: center;
            color: var(--text-secondary);
            padding: 60px 20px;
            font-style: normal;
            font-size: 16px;
        }

        .empty-chart {
            width: 100%;
            height: 250px;
            background: linear-gradient(135deg, #F9FAFB, #F3F4F6);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 16px;
            margin: 20px 0;
            font-weight: 500;
        }

        .delete-btn {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            padding: 8px;
            margin-left: 10px;
            border-radius: 8px;
            transition: var(--transition);
            opacity: 0.6;
        }

        .delete-btn:hover {
            background: rgba(255, 107, 107, 0.1);
            opacity: 1;
            transform: scale(1.1);
        }

        .transaction-actions {
            display: flex;
            align-items: center;
        }

        .install-prompt {
            position: fixed;
            bottom: 80px;
            left: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary-positive), #0EA5E9);
            color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-strong);
            z-index: 999;
            display: none;
            animation: slideUp 0.5s ease-out;
        }

        .install-prompt-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .install-prompt-text {
            flex: 1;
            min-width: 200px;
        }

        .install-prompt h4 {
            font-size: 16px;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .install-prompt p {
            font-size: 13px;
            opacity: 0.9;
            margin: 0;
        }

        .install-prompt-buttons {
            display: flex;
            gap: 10px;
        }

        .install-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: var(--transition);
        }

        .install-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        .install-btn.dismiss {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        @keyframes slideUp {
            from {
                transform: translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Anima√ß√µes */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        /* Estados financeiros - cores din√¢micas */
        .financial-positive {
            --primary-color: var(--primary-positive);
        }

        .financial-negative {
            --primary-color: var(--primary-negative);
        }

        .financial-warning {
            --primary-color: var(--primary-warning);
        }

        /* Responsividade para celular */
        @media (max-width: 768px) {
            .container {
                width: 100%;
                max-width: 100%;
            }
            
            .header {
                padding: 25px 20px;
            }
            
            .username {
                font-size: 24px;
            }
            
            .balance-card, .expense-tracker, .chart-container {
                margin: 20px 15px;
                padding: 25px 20px;
            }
            
            .balance-amount {
                font-size: 32px;
            }
            
            .stats-grid {
                gap: 15px;
                margin: 20px 15px;
            }
            
            .stat-card {
                padding: 20px 15px;
            }
            
            .stat-value {
                font-size: 24px;
            }
            
            .welcome-form {
                padding: 30px 25px;
                margin: 0 15px;
            }
            
            .welcome-title {
                font-size: 32px;
            }
            
            .form-group input, .form-group select {
                padding: 16px 18px;
                font-size: 16px;
            }
            
            .btn {
                padding: 16px;
                font-size: 16px;
            }
            
            .transaction-item, .account-item {
                padding: 18px;
                margin-bottom: 10px;
            }
            
            .transaction-icon, .account-icon {
                width: 45px;
                height: 45px;
                font-size: 18px;
            }
            
            .nav-items {
                max-width: 100%;
                padding: 0 20px;
            }
            
            .add-btn {
                width: 48px;
                height: 48px;
                font-size: 25px;
            }
            
            .chart-container {
                min-height: 280px;
            }
            
            .chart {
                height: 220px !important;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 20px 15px;
            }
            
            .balance-card, .expense-tracker, .chart-container {
                margin: 15px 10px;
                padding: 20px 15px;
            }
            
            .balance-amount {
                font-size: 28px;
            }
            
            .stats-grid {
                gap: 12px;
                margin: 15px 10px;
            }
            
            .stat-card {
                padding: 18px 12px;
            }
            
            .stat-value {
                font-size: 22px;
            }
            
            .welcome-content {
                max-width: 100%;
                padding: 0 15px;
            }
            
            .welcome-form {
                padding: 25px 20px;
            }
            
            .welcome-title {
                font-size: 28px;
            }
            
            .welcome-subtitle {
                font-size: 16px;
            }
            
            .section-title {
                font-size: 18px;
            }
            
            .transaction-item {
                padding: 15px;
            }
            
            .transaction-details h4 {
                font-size: 15px;
            }
            
            .transaction-details p {
                font-size: 12px;
            }
            
            .transaction-amount {
                font-size: 15px;
            }
            
            .prediction-card {
                margin: 15px 10px;
                padding: 25px 20px;
            }
        }

        /* Otimiza√ß√µes para touch */
        @media (hover: none) and (pointer: coarse) {
            .nav-item, .transaction-item, .account-item, .stat-card {
                transition: transform 0.2s ease;
            }
            
            .nav-item:active, .transaction-item:active, 
            .account-item:active, .stat-card:active {
                transform: translateY(-1px);
            }
            
            .btn:active, .welcome-btn:active, .add-btn:active {
                transform: translateY(-1px) scale(0.98);
            }
            
            .delete-btn:active {
                transform: scale(1.05);
            }
        }
    </style>
</head>
<body id="app-body">
    <!-- Tela de Boas-vindas -->
    <div id="welcome-screen" class="welcome-screen">
        <div class="welcome-content">
            <span class="emoji-icon">üí∞</span>
            <h1 class="welcome-title">Controle Financeiro</h1>
            <p class="welcome-subtitle">Gerencie suas finan√ßas de forma inteligente</p>
            
            <div class="welcome-form">
                <input type="text" id="user-name-input" class="welcome-input" placeholder="Qual √© o seu nome?" maxlength="20" required>
                <button onclick="saveUserName()" class="welcome-btn">Come√ßar</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Aba Principal (Relat√≥rios) -->
        <div id="reports-tab" class="tab-content active">
            <div class="header" id="main-header">
                <div class="greeting" id="greeting-text">Bom dia</div>
                <div class="username" id="user-display">Usu√°rio!</div>
            </div>

            <div class="balance-card" id="balance-card">
                <div class="balance-title">Saldo geral</div>
                <div class="balance-amount" id="total-balance">R$ 0,00</div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="total-income" style="color: var(--primary-positive);">R$ 0</div>
                    <div class="stat-label">Total Receitas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-expenses" style="color: var(--primary-negative);">R$ 0</div>
                    <div class="stat-label">Total Despesas</div>
                </div>
            </div>

            <div class="expense-tracker" id="expense-tracker">
                <h3 class="section-title">Gastos Essenciais</h3>
                <div class="expense-bar">
                    <div class="expense-fill" id="expense-bar" style="width: 0%"></div>
                </div>
                <div class="expense-info">
                    <span class="expense-limit" id="expense-limit-text">Limite recomendado R$ 0,00</span>
                    <span class="expense-current" id="current-expenses">R$ 0,00</span>
                </div>
                <div style="font-size: 13px; color: var(--text-secondary); margin-top: 10px; text-align: center; font-weight: 500;">
                    <span id="expense-percentage">0%</span> da sua receita mensal
                </div>
            </div>

            <div class="chart-container">
                <h3 class="section-title">Gastos por Categoria</h3>
                <canvas id="expense-chart" class="chart"></canvas>
            </div>

            <div class="prediction-card" id="prediction-card">
                <h3 style="font-size: 20px; margin-bottom: 12px; font-weight: 700;">An√°lise Financeira</h3>
                <p id="prediction-text">Adicione transa√ß√µes para ver sua an√°lise personalizada! üìä</p>
            </div>
        </div>

        <!-- Aba Adicionar -->
        <div id="add-tab" class="tab-content">
            <div class="header">
                <div class="username">Nova Transa√ß√£o</div>
            </div>

            <div style="margin: 25px; background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow-soft);">
                <form id="transaction-form">
                    <div class="form-group">
                        <label>Tipo</label>
                        <select id="transaction-type" onchange="updateCategoryOptions()">
                            <option value="income">üí∞ Receita</option>
                            <option value="expense">üí∏ Despesa</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Descri√ß√£o</label>
                        <input type="text" id="transaction-description" placeholder="Digite a descri√ß√£o" required>
                    </div>

                    <div class="form-group">
                        <label>Valor</label>
                        <input type="number" id="transaction-amount" placeholder="0,00" step="0.01" required>
                    </div>

                    <div class="form-group">
                        <label>Categoria</label>
                        <select id="transaction-category">
                            <!-- Categorias ser√£o atualizadas dinamicamente -->
                        </select>
                    </div>

                    <button type="submit" class="btn">Adicionar Transa√ß√£o</button>
                </form>
            </div>
        </div>

        <!-- Aba Hist√≥rico -->
        <div id="history-tab" class="tab-content">
            <div class="header">
                <div class="username">Hist√≥rico</div>
            </div>

            <div class="transaction-list" id="transaction-list">
                <div class="no-data-message" id="no-transactions" style="display: none;">
                    üìã Nenhuma transa√ß√£o ainda<br>
                    <small>Adicione receitas e despesas para ver o hist√≥rico</small>
                </div>
            </div>
        </div>

        <!-- Navega√ß√£o -->
        <div class="navigation">
            <div class="nav-items">
                <div class="nav-item active" onclick="switchTab('reports-tab', this)">
                    <span style="font-size: 20px;">üè†</span>
                    <small style="margin-top: 2px; font-weight: 600; font-size: 11px;">In√≠cio</small>
                </div>
                <div class="nav-item" onclick="switchTab('add-tab', this)">
                    <button class="add-btn">+</button>
                    <small style="margin-top: 2px; font-weight: 600; font-size: 11px;">Adicionar</small>
                </div>
                <div class="nav-item" onclick="switchTab('history-tab', this)">
                    <span style="font-size: 20px;">üìã</span>
                    <small style="margin-top: 2px; font-weight: 600; font-size: 11px;">Hist√≥rico</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Prompt de Instala√ß√£o -->
    <div id="install-prompt" class="install-prompt">
        <div class="install-prompt-content">
            <div class="install-prompt-text">
                <h4>üì± Instalar Controle Financeiro</h4>
                <p>Instale o app para acesso r√°pido e uso offline!</p>
            </div>
            <div class="install-prompt-buttons">
                <button class="install-btn dismiss" onclick="dismissInstallPrompt()">Depois</button>
                <button class="install-btn" onclick="installApp()">Instalar</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        let userName = localStorage.getItem('userName') || '';
        let expenseChart;
        let deferredPrompt; // Para guardar o evento de instala√ß√£o

        // PWA - Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swContent = `
                    const CACHE_NAME = 'controle-financeiro-v1';
                    const urlsToCache = [
                        '/',
                        'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js'
                    ];

                    self.addEventListener('install', event => {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then(cache => cache.addAll(urlsToCache))
                        );
                    });

                    self.addEventListener('fetch', event => {
                        event.respondWith(
                            caches.match(event.request)
                                .then(response => response || fetch(event.request))
                        );
                    });
                `;
                
                const blob = new Blob([swContent], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl)
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // PWA - Capturar evento de instala√ß√£o
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevenir o prompt autom√°tico do Chrome
            e.preventDefault();
            // Guardar o evento para usar depois
            deferredPrompt = e;
            // Mostrar nosso prompt customizado
            showInstallPrompt();
        });

        // Mostrar prompt de instala√ß√£o personalizado
        function showInstallPrompt() {
            const installPrompt = document.getElementById('install-prompt');
            const isInstallPromptDismissed = localStorage.getItem('installPromptDismissed');
            
            // S√≥ mostrar se n√£o foi dispensado e se n√£o est√° instalado
            if (!isInstallPromptDismissed && !window.matchMedia('(display-mode: standalone)').matches) {
                setTimeout(() => {
                    installPrompt.style.display = 'block';
                }, 3000); // Mostrar ap√≥s 3 segundos
            }
        }

        // Instalar o app
        async function installApp() {
            if (deferredPrompt) {
                // Mostrar o prompt de instala√ß√£o
                deferredPrompt.prompt();
                
                // Aguardar resposta do usu√°rio
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    console.log('Usu√°rio aceitou instalar o app');
                } else {
                    console.log('Usu√°rio recusou instalar o app');
                }
                
                // Limpar o prompt
                deferredPrompt = null;
            }
            
            // Esconder nosso prompt
            document.getElementById('install-prompt').style.display = 'none';
        }

        // Dispensar prompt de instala√ß√£o
        function dismissInstallPrompt() {
            document.getElementById('install-prompt').style.display = 'none';
            localStorage.setItem('installPromptDismissed', 'true');
            
            // Mostrar novamente ap√≥s 7 dias
            setTimeout(() => {
                localStorage.removeItem('installPromptDismissed');
            }, 7 * 24 * 60 * 60 * 1000);
        }

        // Detectar quando o app √© instalado
        window.addEventListener('appinstalled', (evt) => {
            console.log('App foi instalado com sucesso!');
            document.getElementById('install-prompt').style.display = 'none';
        });
        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        let userName = localStorage.getItem('userName') || '';
        let expenseChart;

        // Categorias espec√≠ficas para cada tipo
        const categories = {
            expense: {
                'cartao': { name: 'Cart√£o de Cr√©dito', icon: 'üí≥' },
                'emprestimo': { name: 'Empr√©stimo', icon: 'üè¶' },
                'luz': { name: 'Conta de Luz', icon: 'üí°' },
                'agua': { name: 'Conta de √Ågua', icon: 'üíß' },
                'internet': { name: 'Internet/TV', icon: 'üì∂' },
                'carro': { name: 'Carro/Combust√≠vel', icon: '‚õΩ' },
                'moradia': { name: 'Aluguel/Financiamento', icon: 'üè†' },
                'alimentacao': { name: 'Alimenta√ß√£o', icon: 'üçΩÔ∏è' },
                'saude': { name: 'Sa√∫de', icon: 'üè•' },
                'lazer': { name: 'Lazer', icon: 'üéÆ' },
                'educacao': { name: 'Educa√ß√£o', icon: 'üìö' },
                'roupas': { name: 'Roupas', icon: 'üëï' },
                'outros': { name: 'Outros', icon: 'üì¶' }
            },
            income: {
                'salario': { name: 'Sal√°rio', icon: 'üíº' },
                'freelance': { name: 'Freelance', icon: 'üíª' },
                'investimento': { name: 'Investimentos', icon: 'üìà' },
                'bonus': { name: 'B√¥nus', icon: 'üéØ' },
                'vendas': { name: 'Vendas', icon: 'üõí' },
                'aposentadoria': { name: 'Aposentadoria', icon: 'üë¥' },
                'pensao': { name: 'Pens√£o', icon: 'üë•' },
                'alugueis': { name: 'Alugu√©is', icon: 'üè¢' },
                'outros': { name: 'Outros', icon: 'üí∞' }
            }
        };

        // Fun√ß√£o para atualizar op√ß√µes de categoria
        function updateCategoryOptions() {
            const typeSelect = document.getElementById('transaction-type');
            const categorySelect = document.getElementById('transaction-category');
            const selectedType = typeSelect.value;
            
            // Limpar op√ß√µes existentes
            categorySelect.innerHTML = '';
            
            // Adicionar novas op√ß√µes baseadas no tipo
            const categoryList = categories[selectedType];
            for (const [key, value] of Object.entries(categoryList)) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = `${value.icon} ${value.name}`;
                categorySelect.appendChild(option);
            }
        }

        function saveUserName() {
            const nameInput = document.getElementById('user-name-input');
            const name = nameInput.value.trim();
            
            if (name) {
                userName = name;
                localStorage.setItem('userName', userName);
                document.getElementById('welcome-screen').style.display = 'none';
                updateGreeting();
            } else {
                alert('Por favor, digite seu nome!');
            }
        }

        function updateGreeting() {
            const now = new Date();
            const hours = now.getHours();
            let greeting = 'Bom dia';
            
            if (hours >= 12 && hours < 18) {
                greeting = 'Boa tarde';
            } else if (hours >= 18) {
                greeting = 'Boa noite';
            }
            
            document.getElementById('greeting-text').textContent = greeting;
            document.getElementById('user-display').textContent = `${userName}!`;
        }

        function checkUserName() {
            if (userName) {
                document.getElementById('welcome-screen').style.display = 'none';
                updateGreeting();
            }
        }

        function setupWelcomeEvents() {
            const nameInput = document.getElementById('user-name-input');
            nameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    saveUserName();
                }
            });
        }

        function updateFinancialTheme(balance, expensePercentage) {
            const body = document.getElementById('app-body');
            const header = document.getElementById('main-header');
            const balanceCard = document.getElementById('balance-card');
            const predictionCard = document.getElementById('prediction-card');
            const balanceAmount = document.getElementById('total-balance');
            
            // Reset classes
            body.classList.remove('financial-positive', 'financial-negative', 'financial-warning');
            
            if (balance > 0) {
                if (expensePercentage <= 30) {
                    // Excelente situa√ß√£o financeira - Verde
                    body.classList.add('financial-positive');
                    header.style.background = 'linear-gradient(135deg, #00D4AA, #0EA5E9)';
                    balanceCard.style.setProperty('--before-bg', '#00D4AA');
                    balanceAmount.style.color = '#00D4AA';
                    predictionCard.style.background = 'linear-gradient(135deg, #00D4AA, #0EA5E9)';
                } else if (expensePercentage <= 50) {
                    // Situa√ß√£o controlada - Azul/Verde
                    body.classList.add('financial-positive');
                    header.style.background = 'linear-gradient(135deg, #0EA5E9, #00D4AA)';
                    balanceCard.style.setProperty('--before-bg', '#0EA5E9');
                    balanceAmount.style.color = '#0EA5E9';
                    predictionCard.style.background = 'linear-gradient(135deg, #0EA5E9, #00D4AA)';
                } else {
                    // Aten√ß√£o necess√°ria - Amarelo/Laranja
                    body.classList.add('financial-warning');
                    header.style.background = 'linear-gradient(135deg, #FFB800, #FF8C00)';
                    balanceCard.style.setProperty('--before-bg', '#FFB800');
                    balanceAmount.style.color = '#FF8C00';
                    predictionCard.style.background = 'linear-gradient(135deg, #FFB800, #FF6B6B)';
                }
            } else {
                // Situa√ß√£o negativa - Vermelho
                body.classList.add('financial-negative');
                header.style.background = 'linear-gradient(135deg, #FF6B6B, #EE5A24)';
                balanceCard.style.setProperty('--before-bg', '#FF6B6B');
                balanceAmount.style.color = '#FF6B6B';
                predictionCard.style.background = 'linear-gradient(135deg, #FF6B6B, #EE5A24)';
            }
        }

        function switchTab(tabId, element) {
            // Esconder todas as abas
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
                tab.scrollTop = 0;
            });
            
            // Remover active de todos os nav items
            document.querySelectorAll('.nav-item').forEach(nav => {
                nav.classList.remove('active');
            });
            
            // Mostrar aba selecionada e ativar nav item
            document.getElementById(tabId).classList.add('active');
            element.classList.add('active');
            
            if (tabId === 'reports-tab') {
                setTimeout(() => {
                    updateChart();
                }, 100);
            }
        }

        function saveTransactions() {
            localStorage.setItem('transactions', JSON.stringify(transactions));
        }

        function updateUI() {
            const totalIncome = transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
                
            const totalExpenses = transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
                
            const balance = totalIncome - totalExpenses;
            
            // Atualizar saldo total
            document.getElementById('total-balance').textContent = `R$ ${balance.toFixed(2).replace('.', ',')}`;
            
            // Calcular limite de gastos essenciais (50% da receita total)
            const essentialLimit = totalIncome * 0.5;
            
            // Atualizar gastos essenciais (agora incluindo mais categorias essenciais)
            const essentialExpenses = transactions
                .filter(t => t.type === 'expense' && ['alimentacao', 'moradia', 'luz', 'agua', 'internet', 'carro', 'saude'].includes(t.category))
                .reduce((sum, t) => sum + t.amount, 0);
                
            document.getElementById('current-expenses').textContent = `R$ ${essentialExpenses.toFixed(2).replace('.', ',')}`;
            document.getElementById('expense-limit-text').textContent = `Limite recomendado R$ ${essentialLimit.toFixed(2).replace('.', ',')}`;
            
            // Calcular porcentagem dos gastos essenciais
            const expensePercentage = totalIncome > 0 ? Math.min((essentialExpenses / essentialLimit) * 100, 100) : 0;
            const actualPercentage = totalIncome > 0 ? (essentialExpenses / totalIncome) * 100 : 0;
            
            document.getElementById('expense-bar').style.width = `${expensePercentage}%`;
            document.getElementById('expense-percentage').textContent = `${actualPercentage.toFixed(1)}%`;
            
            // Mudar cor da barra baseado na porcentagem
            const expenseBar = document.getElementById('expense-bar');
            if (actualPercentage <= 30) {
                expenseBar.style.background = 'linear-gradient(90deg, #00D4AA, #0EA5E9)';
            } else if (actualPercentage <= 50) {
                expenseBar.style.background = 'linear-gradient(90deg, #FFB800, #FF8C00)';
            } else {
                expenseBar.style.background = 'linear-gradient(90deg, #FF6B6B, #EE5A24)';
            }
            
            // Atualizar tema baseado na situa√ß√£o financeira
            updateFinancialTheme(balance, actualPercentage);
            
            // Atualizar estat√≠sticas
            document.getElementById('total-income').textContent = `R$ ${totalIncome.toFixed(0)}`;
            document.getElementById('total-expenses').textContent = `R$ ${totalExpenses.toFixed(0)}`;
            
            // Atualizar previs√£o com mensagens mais detalhadas
            let prediction = "Adicione transa√ß√µes para ver sua an√°lise personalizada! üìä";
            
            if (totalIncome > 0 && totalExpenses > 0) {
                if (balance > 0) {
                    if (actualPercentage <= 30) {
                        prediction = "üéâ Excelente! Sua situa√ß√£o financeira est√° √≥tima. Gastos controlados e saldo positivo. Continue assim!";
                    } else if (actualPercentage <= 50) {
                        prediction = "üëç Boa gest√£o! Seus gastos est√£o dentro do recomendado. Considere investir o excedente.";
                    } else {
                        prediction = "‚ö†Ô∏è Aten√ß√£o! Gastos essenciais altos. Revise alimenta√ß√£o, transporte e moradia para manter o saldo positivo.";
                    }
                } else {
                    prediction = "üö® Saldo negativo! Urgente: reduza gastos ou aumente sua receita. Priorize apenas o essencial.";
                }
            }
                
            document.getElementById('prediction-text').textContent = prediction;
            
            updateTransactionList();
        }

        function deleteTransaction(transactionId) {
            if (confirm('Tem certeza que deseja excluir esta transa√ß√£o?')) {
                transactions = transactions.filter(t => t.id !== transactionId);
                saveTransactions();
                updateUI();
            }
        }

        function updateTransactionList() {
            const list = document.getElementById('transaction-list');
            const noDataMessage = document.getElementById('no-transactions');
            
            // Limpar lista mantendo a mensagem de "sem dados"
            const children = Array.from(list.children);
            children.forEach(child => {
                if (child.id !== 'no-transactions') {
                    child.remove();
                }
            });
            
            const recentTransactions = transactions.slice(-20).reverse();
            
            if (recentTransactions.length === 0) {
                noDataMessage.style.display = 'block';
                return;
            }
            
            noDataMessage.style.display = 'none';
            
            recentTransactions.forEach(transaction => {
                const item = document.createElement('div');
                item.className = 'transaction-item';
                
                const date = new Date(transaction.date);
                const formattedDate = date.toLocaleDateString('pt-BR', { 
                    day: '2-digit', 
                    month: '2-digit',
                    year: 'numeric'
                });
                
                // Obter informa√ß√µes da categoria
                const categoryInfo = categories[transaction.type][transaction.category] || { name: 'Outros', icon: 'üì¶' };
                
                item.innerHTML = `
                    <div style="display: flex; align-items: center; flex: 1;">
                        <div class="transaction-icon ${transaction.type}">
                            ${transaction.type === 'income' ? 'üí∞' : categoryInfo.icon}
                        </div>
                        <div class="transaction-details" style="margin-left: 15px;">
                            <h4>${transaction.description}</h4>
                            <p>${categoryInfo.name} ‚Ä¢ ${formattedDate}</p>
                        </div>
                    </div>
                    <div class="transaction-actions">
                        <div class="transaction-amount ${transaction.type}">
                            ${transaction.type === 'income' ? '+' : '-'}R$ ${transaction.amount.toFixed(2).replace('.', ',')}
                        </div>
                        <button class="delete-btn" onclick="deleteTransaction(${transaction.id})">üóëÔ∏è</button>
                    </div>
                `;
                
                list.appendChild(item);
            });
        }

        function updateChart() {
            const canvas = document.getElementById('expense-chart');
            const ctx = canvas.getContext('2d');
            
            if (expenseChart) {
                expenseChart.destroy();
            }
            
            const expensesByCategory = {};
            transactions.filter(t => t.type === 'expense').forEach(t => {
                expensesByCategory[t.category] = (expensesByCategory[t.category] || 0) + t.amount;
            });
            
            // Se n√£o h√° dados, mostrar mensagem
            if (Object.keys(expensesByCategory).length === 0) {
                canvas.style.display = 'none';
                let noDataDiv = document.getElementById('no-data-chart');
                if (!noDataDiv) {
                    noDataDiv = document.createElement('div');
                    noDataDiv.id = 'no-data-chart';
                    noDataDiv.className = 'empty-chart';
                    noDataDiv.textContent = 'üìä Adicione despesas para ver o gr√°fico';
                    canvas.parentNode.appendChild(noDataDiv);
                }
                noDataDiv.style.display = 'flex';
                return;
            }
            
            // Remover mensagem de "sem dados" se existir
            const noDataDiv = document.getElementById('no-data-chart');
            if (noDataDiv) {
                noDataDiv.style.display = 'none';
            }
            canvas.style.display = 'block';
            
            // Criar labels usando as novas categorias
            const chartLabels = Object.keys(expensesByCategory).map(categoryKey => {
                const categoryInfo = categories.expense[categoryKey];
                return categoryInfo ? categoryInfo.name : 'Outros';
            });
            
            const colors = [
                '#FF6B6B', '#00D4AA', '#0EA5E9', '#FFB800', 
                '#FF8C00', '#4ECDC4', '#96CEB4', '#54A0FF'
            ];
            
            const gradientColors = colors.map(color => {
                const gradient = ctx.createLinearGradient(0, 0, 0, 400);
                gradient.addColorStop(0, color);
                gradient.addColorStop(1, color + '80');
                return gradient;
            });
            
            expenseChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: chartLabels,
                    datasets: [{
                        data: Object.values(expensesByCategory),
                        backgroundColor: gradientColors,
                        borderWidth: 0,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '65%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                pointStyle: 'circle',
                                font: {
                                    size: 13,
                                    weight: '600'
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            cornerRadius: 12,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `R$ ${value.toFixed(2).replace('.', ',')} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    layout: {
                        padding: 20
                    },
                    elements: {
                        arc: {
                            borderRadius: 8
                        }
                    }
                }
            });
        }

        document.getElementById('transaction-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const type = document.getElementById('transaction-type').value;
            const description = document.getElementById('transaction-description').value;
            const amount = parseFloat(document.getElementById('transaction-amount').value);
            const category = document.getElementById('transaction-category').value;
            
            if (amount <= 0) {
                alert('Por favor, insira um valor v√°lido!');
                return;
            }
            
            const transaction = {
                id: Date.now(),
                type,
                description,
                amount,
                category,
                date: new Date().toISOString()
            };
            
            transactions.push(transaction);
            saveTransactions();
            updateUI();
            
            // Limpar formul√°rio
            document.getElementById('transaction-form').reset();
            
            // Mostrar feedback visual
            const btn = document.querySelector('.btn');
            const originalText = btn.textContent;
            btn.textContent = '‚úÖ Adicionado!';
            btn.style.background = 'linear-gradient(135deg, #00D4AA, #0EA5E9)';
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = 'linear-gradient(135deg, var(--primary-positive), #0EA5E9)';
                // Voltar para a aba inicial
                switchTab('reports-tab', document.querySelector('.nav-item'));
            }, 1500);
        });

        // Inicializar aplica√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            setupWelcomeEvents();
            checkUserName();
            updateCategoryOptions(); // Inicializar categorias
            updateUI();
            
            // Adicionar efeitos de hover suaves
            document.querySelectorAll('.nav-item, .stat-card, .account-item, .transaction-item').forEach(element => {
                element.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px)';
                });
                
                element.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
        });
    </script>
</body>
</html>